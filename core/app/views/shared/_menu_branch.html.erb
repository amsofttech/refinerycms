<%
  if !!local_assigns[:apply_css] and (classes = menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')}'"
  end
  dom_id = "id='item_#{menu_branch_counter}'"

  children = menu_branch.children unless hide_children
-%>
<li<%= ['', css, dom_id].compact.join(' ').gsub(/\ *$/, '') %>>
  <%= link_to menu_branch.title, menu_branch.url -%>
  <% if children.present? -%>
    <ul class='clearfix'>
        <%=
        render :partial => '/shared/menu_branch',
               :collection => children,
               :locals => {
                 :apply_css => local_assigns[:apply_css],
                 :hide_children => !!hide_children,
                 :collection => collection,
                 :sibling_count => children.size - 1
               } -%>
    </ul>
  <% end -%>
</li>